---
title: 初识大中台
urlname: about-middle-end
date: 2019-12-07 16:20:59
category: 杂谈
tags: other
---

最近朋友分享给我了一篇文章—— [《叹！中台的末路》](https://mp.weixin.qq.com/s/Pge_G3bVk40b70YpwCOx3Q)，问我的公司是否像文中说的一样：“吹牛逼的时候大家都是拣好的说，苦逼的东西就只有内部人士知道”。其实这句话适用的范围很广，只能说如人饮水冷暖自知，比如你觉得一些公司非常厉害，但是在 `脉脉` 上可能会看到 `内部员工` 的各种抱怨：PUA /内卷 严重、拿不到离职证明等。

> 从 15 年开始，到 19 年现在为止，各大公司都在吹捧中台理念。仿佛中台是业务复杂性的救世主，是某些架构师和 PM 的新出路，各种割韭菜的讲中台的课程层出不穷。
—— 《叹！中台的末路》

<!-- more -->

趁这个机会简单整理下我们公司的中台项目：成立于 2018 年 12 月 21 日，旨在实现 **大中台 + 小前台** 的技术架构和组织架构，解决目前普遍存在的新产品开发速度慢、老产品维护困难、大量的低效重复劳动等问题，打造一个整合公司核心业务的高内聚、低耦合、高可用的共享平台，为前台业务拓展提供强有力的支持。

![Arsenal架构](/images/arsenal-structure.png)

名词解释：

- OpenAPI：提供服务调用的统一入口网关，所有的服务调用都通过这个网关转发
- AIP：Agent Interface Process，微服务架构中的代理接口进程。提供请求调用的接口，把请求发给相应的 SIP 或者 SIK，具有均衡的功能
- AIK：Agent Interface SDK，微服务架构中的代理接口 SDK，提供给服务使用者程序开发函数库。功能和 AIP 保持一致，但性能更好，没有进程间的通讯
- SIP：Service Interface Process，微服务架构中的服务接口进程。接收请求，调用相应的服务进程处理并返回处理结果，类似 Nginx 的作用
- SIK：Service Interface SDK，微服务架构中的服务接口 SDK。提供给服务开发者使用的函数库。功能和 SIP 保持一致，但性能更好，没有进程间的通讯
- MSA：MicroService Application，微服务架构中的应用程序，实现业务逻辑，对外的表现就是服务
- SRRP：Standard Request Response Protocol，标准请求应答协议。定义 MSA 和 AIP（SIP）之间的数据交换协议
- 控制面：Control Plane。微服务架构中的配置中心，管理服务的注册和服务（应用）之间的调用关系，实现服务注册、发现、健康检查等功能

![AIP-SIP微服务架构](/images/aip-sip-structure.png)

公用业务下沉，这个理念其实很朴素。程序员都知道我们公用的逻辑要进行封装、抽象，变成 *Library*，而中台的本质其实就是把这种朴素的思想进行了一定程度的推广。

每个部门都需要在中台上注册一个自己的 `应用`，这个应用可以提供 `服务` 给别人，也可以使用别人的服务。简单来说，使用外部门的接口时需要在控制台中为自己的应用关联这个服务，提供接口给别人时需要在控制台中发布这个服务。

老的接入流程需要在各个环境服务器上发 CURL 请求，访问微服务控制面来注册应用，流程非常繁琐

后来改版提供了网关模式，把服务暴露出的虚拟域名统一添加网关服务器到 HOST，再在请求接口时在 HTTP Header 里附上自己的应用名（应用与服务有依赖关系），就实现了注册、鉴权流程。

大中台的优点如下：

- 工程方面
有效减少了重复造轮子、重复建系统的现象。有相对统一的业务收敛位置，并在公共服务上快速高效迭代出新的业务

- 数据方面
有了统一的用户、交易系统，就不会再有各种数据打通问题，不会有跨部门的数据墙。有了统一的中台，也就有了统一的数据规范。对于大数据相关的需求，可以从相对唯一的数据出口进行业务迭代，不需要为每一个部门进行定制开发，浪费人力

- 创新方面
有了公共的中台，意味着有了相对全局的视角，更能发现单点观察难以发现的问题，在更大的业务层面进行一定的创新

不过这些优点都是理论上的，例如特殊需求带来的接口调整、新系统直接复制代码等现象还广泛存在

目前中台还处于完善阶段，除了接口，还添加了 UI 组件、ELK 日志及图表、Mock 工具、公共 Kafka 等

![目前提供的服务](/images/arsenal-service.jpg)
