---
title: 重构--改善既有代码的设计
urlname: how-to-refactor
date: 2019-03-07 16:44:52
category: 杂谈
---

抽时间读了这本非常有名的书《重构--改善既有代码的设计》，结合一下网上大佬分享的思路，与自己平时的经验，写写小感悟。
重构不是对以前代码的全盘否定，而是利用更好的方式，写出更好、更有维护性的代码。

<!-- more -->

## 什么是重构

首先，重构不是重写。重构大概的意思是在不影响项目的功能使用前提下，使用一系列的重构方式，改变项目的内部结构。提高项目内部的可读性，可维护性。

无论是什么项目，都有一个从简单到复杂的一个迭代过程。在这个过程里面，在不影响项目的使用情况下，需要不断的对代码进行优化，保持或者增加代码的可读性，可维护性。这样一来，就可以避免在团队协作开发上需要大量的沟通，交流。才能加入项目的开发中。

## 为什么重构

随着业务需求的不断增加，变更，舍弃，项目的代码也难免会出现瑕疵，这就会影响代码的可读性，可维护性，甚至影响项目的性能。而重构的目的，就是为了解决这些瑕疵，保证代码质量和性能。但是前提是不能影响项目的使用。

至于重构的原因，自己总结了一下，大概有以下几点：

1. 函数逻辑结构混乱，或因为没注释原因，连原代码写作者都很难理清当中的逻辑。
2. 函数无扩展性可言，遇到新的变化，不能灵活的处理。
3. 因为对象强耦合或者业务逻辑的原因，导致业务逻辑的代码巨大，维护的时候排查困难。
4. 重复代码太多，没有复用性。
5. 随着技术的发展，代码可能也需要使用新特性进行修改。
6. 随着学习的深入，对于以前的代码，是否有着更好的一个解决方案。
7. 因为代码的写法，虽然功能正常使用，但是性能消耗较多，需要换方案进行优化

## 何时重构

在我的理解中，重构可以说是贯穿整一个项目的开发和维护周期，可以当作重构就是开发的一部分。通俗讲，在开发的任何时候，只要看到代码有别扭，激发了强迫症，就可以考虑重构了。
只是，重构之前先参考下面几点：

- 首先，重构是需要花时间去做的一件事。花的时间可能比之前的开发时间还要多。
- 其次，重构是为了把代码优化，前提是不能影响项目的使用。
- 最后，重构的难度大小不一，可能只是稍微改动，可能难度比之前开发还要难。

基于上面的几点，需要大家去评估是否要进行重构。
评估的指标，可以参考下面几点：

- 数量: 需要重构的代码是否过多。
- 质量: 可读性，可维护性，代码逻辑复杂度，等问题，对代码的质量影响是否到了一个难以忍受的地步。
- 时间: 是否有充裕的时间进行重构和测试。
- 效果: 如果重构了代码，得到哪些改善，比如代码质量提高了，性能提升了，更好的支持后续功能等。
