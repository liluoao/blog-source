---
title: 版本控制工具提交规范
urlname: vcs-commit-rule
date: 2019-10-15 10:54:21
category: 工具
tags: [tool]
---

## 前言

在日常工作中，我们经常会使用版本控制工具，不管是 **Git** 还是 **SVN**，或是其它。

在多人协作中，提交注释是一个可能会忽视的点。**清晰明了的注释**可以降低沟通成本，提高工作效率。而**含糊不清的注释**会在你需要找一次具体提交时造成麻烦。

<!-- more -->

## 规范内容

最基础的规范，也是最重要的——就是每个任务的代码分开提交。这样在 Review 的时候比较清楚，出现 BUG 后可以快速回退单次提交。如果代码管理水平不足，出现了几个环境代码不统一，需要手动合并代码时，可能这个任务需要发布正式，另一个任务只需要发布测试或者预发布，糅杂在一起的提交就会导致噩梦般的后果。

团队合作中一般会使用到事务跟踪工具，例如 [JIRA](https://www.atlassian.com/software/jira)、[禅道](https://www.zentao.net/) 等。每个开发任务有自己的编号，在提交时一定要带上。

其它规范因人而异，举个例子：

先把文件按类型分为如下几种

- 【视图】如 Blade、Smarty、PHTML 等
- 【功能】一般是业务代码，根据项目结构不同可分为 Model、Bean、Business 等
- 【脚本】定时脚本 Crontab 类，也叫 Job
- 【测试】单元测试，也叫 Test
- 【插件】有的框架如 Yaf、Yii 中存在的概念，或者是自己封装的工具类
- 【配置】根据项目要求的不同，有 php，ini，env，XML，Json 等
- 【前端】JS、CSS、image等，或者是组件
- 【接口】提供给外部的接口
- 【API】调用的外部接口，可进一步分为公司内部的和外网的
- 【SQL】也叫做 Migration。数据库迁移文件，或是结构变更的纯 SQL
- 【FUNC】也叫做 helper，全局函数文件

最后拼装成一整条 `commit message`

> 【任务编号】【新增|修改|删除】【功能|视图|脚本|等】任务标题-功能备注

如果是复制的代码，可在后面加上 `@copy`（如果有统计代码量的要求）。再提一嘴，部分要找历史提交的原因可能是因为需求有变更，要还原回之前的代码。刚好脉脉给我推送了一条通知——删除代码时是注释掉还是直接删除。我的选择毫无疑问是直接删除掉，因为有版本控制工具在，找历史还是没啥难度的。如果是仅注释掉的话，代码的美观性可想而知（代码洁癖实锤）。
